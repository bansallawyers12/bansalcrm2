(async function(){typeof window.vendorLibsReady<"u"?await window.vendorLibsReady:await new Promise(e=>{const a=()=>{typeof $<"u"&&typeof $.fn.select2=="function"?e():setTimeout(a,50)};a()}),jQuery(document).ready(function(e){const a=(t,n)=>typeof App<"u"&&typeof App.getUrl=="function"&&App.getUrl(t)||n,d=a("getRecipients",a("siteUrl","")+"/clients/get-recipients"),m=a("getTemplates",a("siteUrl","")+"/get-templates");function u(t){if(t.loading)return t.text;const n=e("<div  class='select2-result-repository ag-flex ag-space-between ag-align-center'><div  class='ag-flex ag-align-start'><div  class='ag-flex ag-flex-column col-hr-1'><div class='ag-flex'><span  class='select2-result-repository__title text-semi-bold'></span>&nbsp;</div><div class='ag-flex ag-align-center'><small class='select2-result-repository__description'></small ></div></div></div><div class='ag-flex ag-flex-column ag-align-end'><span class='ui label yellow select2-result-repository__statistics'></span></div></div>");return n.find(".select2-result-repository__title").text(t.name||t.text||""),n.find(".select2-result-repository__description").text(t.email||""),n.find(".select2-result-repository__statistics").append(t.status||""),n}function p(t){return t.name||t.text}function o(t){!t.length||typeof e.fn.select2!="function"||t.data("select2")||t.select2({multiple:!0,closeOnSelect:!1,dropdownParent:e("#emailmodal"),ajax:{url:d,dataType:"json",processResults:function(n){return{results:n.items||[]}},cache:!0},templateResult:u,templateSelection:p})}o(e(".js-data-example-ajax")),o(e(".js-data-example-ajaxcc")),e(document).on("click",".clientemail",function(){e("#emailmodal").modal("show");const t=e(this).attr("data-rec-name")||"",n=e(this).attr("data-id")||"",c=e(this).attr("data-href")||"#";e("#receipt").length&&e("#receipt").text(t).attr("href",c),e('input[name="receipt"]').val(n);const s=e(this).attr("data-cus-id"),l=e(this).attr("data-email"),r=e(this).attr("data-name"),i=e(".js-data-example-ajax");if(o(i),s&&r){const f=new Option(r,s,!0,!0);i.append(f).trigger("change")}i.data("select2")&&(i.select2("open"),i.select2("close")),l&&typeof e.fn.select2=="function"&&i.trigger({type:"select2:select",params:{data:{id:s,text:r,email:l,status:"Client"}}})}),e(document).on("change",".selecttemplate",function(){const t=e(this).val();t&&e.ajax({url:m,type:"GET",datatype:"json",data:{id:t},success:function(n){const c=typeof n=="string"?JSON.parse(n):n,s=c.subject||"",l=c.description||"";e(".selectedsubject").val(s),e("#emailmodal .summernote-simple").length&&typeof e.fn.summernote<"u"&&(e("#emailmodal .summernote-simple").summernote("reset"),e("#emailmodal .summernote-simple").summernote("code",l)),e("#emailmodal .summernote-simple").val(l)}})}),e(document).on("click",".openpaymentform",function(){const t=e(this).attr("data-invoiceid"),n=e(this).attr("data-netamount");e("#invoice_id").val(t),e(".invoicenetamount").html(n+" AUD"),e(".totldueamount").html("0 AUD"),e("#addpaymentmodal").modal("show"),e(".paymentAmount").val(n)})})})();
